2025-09-26 16:22:19 [ERR] An error occurred using the connection to database '' on server 'localhost'.
2025-09-26 16:22:19 [ERR] Erro ao inicializar banco de dados do EstoqueService
MySqlConnector.MySqlException (0x80004005): Access denied for user 'root'@'localhost' (using password: YES)
   at MySqlConnector.Core.ServerSession.ReceiveReplyAsync(IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/ServerSession.cs:line 1081
   at MySqlConnector.Core.ServerSession.SendClearPasswordAsync(String password, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/ServerSession.cs:line 931
   at MySqlConnector.Core.ServerSession.SwitchAuthenticationAsync(ConnectionSettings cs, String password, PayloadData payload, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/ServerSession.cs:line 900
   at MySqlConnector.Core.ServerSession.ConnectAsync(ConnectionSettings cs, MySqlConnection connection, Int64 startingTimestamp, ILoadBalancer loadBalancer, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/ServerSession.cs:line 539
   at MySqlConnector.Core.ServerSession.ConnectAndRedirectAsync(ILogger connectionLogger, ILogger poolLogger, IConnectionPoolMetadata pool, ConnectionSettings cs, ILoadBalancer loadBalancer, MySqlConnection connection, Action`4 logMessage, Int64 startingTimestamp, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/ServerSession.cs:line 697
   at MySqlConnector.Core.ServerSession.ConnectAndRedirectAsync(ILogger connectionLogger, ILogger poolLogger, IConnectionPoolMetadata pool, ConnectionSettings cs, ILoadBalancer loadBalancer, MySqlConnection connection, Action`4 logMessage, Int64 startingTimestamp, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/ServerSession.cs:line 702
   at MySqlConnector.Core.ConnectionPool.GetSessionAsync(MySqlConnection connection, Int64 startingTimestamp, Int32 timeoutMilliseconds, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/ConnectionPool.cs:line 116
   at MySqlConnector.Core.ConnectionPool.GetSessionAsync(MySqlConnection connection, Int64 startingTimestamp, Int32 timeoutMilliseconds, Activity activity, IOBehavior ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/Core/ConnectionPool.cs:line 150
   at MySqlConnector.MySqlConnection.CreateSessionAsync(ConnectionPool pool, Int64 startingTimestamp, Activity activity, Nullable`1 ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlConnection.cs:line 1092
   at MySqlConnector.MySqlConnection.OpenAsync(Nullable`1 ioBehavior, CancellationToken cancellationToken) in /_/src/MySqlConnector/MySqlConnection.cs:line 567
   at MySqlConnector.MySqlConnection.Open() in /_/src/MySqlConnector/MySqlConnection.cs:line 522
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenDbConnection(Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternal(Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.Open(Boolean errorsExpected)
   at Pomelo.EntityFrameworkCore.MySql.Storage.Internal.MySqlRelationalConnection.Open(Boolean errorsExpected)
   at Pomelo.EntityFrameworkCore.MySql.Storage.Internal.MySqlDatabaseCreator.<>c__DisplayClass18_0.<Exists>b__0(DateTime giveUp)
   at Microsoft.EntityFrameworkCore.ExecutionStrategyExtensions.<>c__DisplayClass12_0`2.<Execute>b__0(DbContext _, TState s)
   at Pomelo.EntityFrameworkCore.MySql.Storage.Internal.MySqlExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.ExecutionStrategyExtensions.Execute[TState,TResult](IExecutionStrategy strategy, TState state, Func`2 operation, Func`2 verifySucceeded)
   at Microsoft.EntityFrameworkCore.ExecutionStrategyExtensions.Execute[TState,TResult](IExecutionStrategy strategy, TState state, Func`2 operation)
   at Pomelo.EntityFrameworkCore.MySql.Storage.Internal.MySqlDatabaseCreator.Exists(Boolean retryOnNotExists)
   at Pomelo.EntityFrameworkCore.MySql.Storage.Internal.MySqlDatabaseCreator.Exists()
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabaseCreator.EnsureCreated()
   at Microsoft.EntityFrameworkCore.Infrastructure.DatabaseFacade.EnsureCreated()
   at Program.<Main>$(String[] args) in G:\Desafio-Técnico-Avanade\EcommerceMicroservices\EstoqueService\Program.cs:line 118
2025-09-26 16:22:19 [INF] EstoqueService iniciado em Development
2025-09-26 16:22:19 [INF] User profile is available. Using 'C:\Users\vcost\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-26 16:22:20 [INF] VendaConsumer iniciado e conectado ao RabbitMQ
2025-09-26 16:22:20 [INF] Now listening on: https://localhost:7261
2025-09-26 16:22:20 [INF] Now listening on: http://localhost:5045
2025-09-26 16:22:20 [INF] Application started. Press Ctrl+C to shut down.
2025-09-26 16:22:20 [INF] Hosting environment: Development
2025-09-26 16:22:20 [INF] Content root path: G:\Desafio-Técnico-Avanade\EcommerceMicroservices\EstoqueService
2025-09-26 16:22:54 [INF] Request starting HTTP/2 GET https://localhost:7261/ - null null
2025-09-26 16:22:56 [INF] Request finished HTTP/2 GET https://localhost:7261/ - 404 0 null 1947.191ms
2025-09-26 16:22:56 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET https://localhost:7261/, Response status code: 404
2025-09-26 16:23:03 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - null null
2025-09-26 16:23:03 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 257.1216ms
2025-09-26 16:25:52 [INF] Request starting HTTP/2 POST https://localhost:7261/api/Auth/login - application/json 46
2025-09-26 16:25:52 [INF] CORS policy execution successful.
2025-09-26 16:25:52 [INF] Executing endpoint 'EstoqueService.Controllers.AuthController.Login (EstoqueService)'
2025-09-26 16:25:52 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Login(EstoqueService.Controllers.LoginRequest) on controller EstoqueService.Controllers.AuthController (EstoqueService).
2025-09-26 16:25:53 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-26 16:25:53 [INF] Executed action EstoqueService.Controllers.AuthController.Login (EstoqueService) in 408.6346ms
2025-09-26 16:25:53 [INF] Executed endpoint 'EstoqueService.Controllers.AuthController.Login (EstoqueService)'
2025-09-26 16:25:53 [INF] Request finished HTTP/2 POST https://localhost:7261/api/Auth/login - 200 null application/json; charset=utf-8 471.4072ms
2025-09-26 16:26:50 [INF] Request starting HTTP/2 GET https://localhost:7261/configuration - null null
2025-09-26 16:26:50 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-09-26 16:26:50 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-26 16:26:50 [INF] Request finished HTTP/2 GET https://localhost:7261/configuration - 401 0 null 17.1833ms
2025-09-26 16:26:58 [INF] Request starting HTTP/2 POST https://localhost:7261/configuration - application/json 4634
2025-09-26 16:26:58 [INF] CORS policy execution successful.
2025-09-26 16:26:58 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-09-26 16:26:58 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-26 16:26:58 [INF] Request finished HTTP/2 POST https://localhost:7261/configuration - 401 0 null 11.0043ms
2025-09-26 16:27:05 [INF] Request starting HTTP/2 GET https://localhost:7261/api/Produtos - null null
2025-09-26 16:27:05 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-09-26 16:27:05 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-26 16:27:05 [INF] Request finished HTTP/2 GET https://localhost:7261/api/Produtos - 401 0 null 21.4942ms
2025-09-26 16:27:30 [INF] Request starting HTTP/2 POST https://localhost:7261/api/Produtos - application/json 91
2025-09-26 16:27:31 [INF] CORS policy execution successful.
2025-09-26 16:27:31 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-09-26 16:27:31 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-26 16:27:31 [INF] Request finished HTTP/2 POST https://localhost:7261/api/Produtos - 401 0 null 8.0262ms
2025-09-26 16:27:35 [INF] Request starting HTTP/2 POST https://localhost:7261/api/Produtos - application/json 91
2025-09-26 16:27:35 [INF] CORS policy execution successful.
2025-09-26 16:27:35 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-09-26 16:27:35 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-26 16:27:35 [INF] Request finished HTTP/2 POST https://localhost:7261/api/Produtos - 401 0 null 25.6103ms
2025-09-26 16:27:49 [INF] Request starting HTTP/2 PATCH https://localhost:7261/api/Produtos/1/estoque - application/json 55
2025-09-26 16:27:49 [INF] CORS policy execution successful.
2025-09-26 16:27:49 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-09-26 16:27:49 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-26 16:27:49 [INF] Request finished HTTP/2 PATCH https://localhost:7261/api/Produtos/1/estoque - 401 0 null 9.1119ms
2025-09-26 16:28:03 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/index.html - null null
2025-09-26 16:28:03 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/index.html - 200 null text/html;charset=utf-8 166.066ms
2025-09-26 16:28:03 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - null null
2025-09-26 16:28:03 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 16.8838ms
2025-09-26 16:34:09 [INF] Application is shutting down...
2025-09-26 16:34:09 [INF] VendaConsumer sendo finalizado
2025-09-26 16:34:09 [INF] Parando VendaConsumer...
2025-09-26 16:34:27 [INF] Executed DbCommand (36ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE DATABASE `EstoqueDB`;
2025-09-26 16:34:27 [INF] Executed DbCommand (26ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER DATABASE CHARACTER SET utf8mb4;
2025-09-26 16:34:27 [INF] Executed DbCommand (103ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE `Produtos` (
    `Id` int NOT NULL AUTO_INCREMENT,
    `Nome` varchar(100) CHARACTER SET utf8mb4 NOT NULL,
    `Descricao` longtext CHARACTER SET utf8mb4 NOT NULL,
    `Preco` decimal(18,2) NOT NULL,
    `Quantidade` int NOT NULL,
    CONSTRAINT `PK_Produtos` PRIMARY KEY (`Id`)
) CHARACTER SET=utf8mb4;
2025-09-26 16:34:27 [INF] Banco de dados do EstoqueService inicializado
2025-09-26 16:34:27 [INF] EstoqueService iniciado em Development
2025-09-26 16:34:27 [INF] User profile is available. Using 'C:\Users\vcost\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-26 16:34:27 [INF] VendaConsumer iniciado e conectado ao RabbitMQ
2025-09-26 16:34:27 [INF] Now listening on: https://localhost:7261
2025-09-26 16:34:27 [INF] Now listening on: http://localhost:5045
2025-09-26 16:34:27 [INF] Application started. Press Ctrl+C to shut down.
2025-09-26 16:34:27 [INF] Hosting environment: Development
2025-09-26 16:34:27 [INF] Content root path: G:\Desafio-Técnico-Avanade\EcommerceMicroservices\EstoqueService
2025-09-26 16:34:38 [INF] Request starting HTTP/1.1 GET http://localhost:5045/ - null null
2025-09-26 16:34:38 [INF] Request finished HTTP/1.1 GET http://localhost:5045/ - 307 0 null 172.3195ms
2025-09-26 16:34:38 [INF] Request starting HTTP/2 GET https://localhost:7261/ - null null
2025-09-26 16:34:38 [INF] Request finished HTTP/2 GET https://localhost:7261/ - 404 0 null 27.262ms
2025-09-26 16:34:39 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET https://localhost:7261/, Response status code: 404
2025-09-26 16:34:44 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/index.html - null null
2025-09-26 16:34:44 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/index.html - 200 null text/html;charset=utf-8 121.5907ms
2025-09-26 16:34:44 [INF] Request starting HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - null null
2025-09-26 16:34:44 [INF] Request finished HTTP/2 GET https://localhost:7261/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 128.3139ms
